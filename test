function exportToCSV(items) {
  // Create CSV header row
  var header = "Attribute Name,Value\r\n";

  // Create CSV data rows
  var rows = "";
  for (var i = 0; i < items.length; i++) {
    var attributes = items[i].attributes;
    for (var attributeName in attributes) {
      if (attributes.hasOwnProperty(attributeName)) {
        rows += attributeName + "," + attributes[attributeName] + "\r\n";
      }
    }
  }

  // Combine header and data rows
  var csv = header + rows;

  // Create download link and trigger click event
  var encodedUri = encodeURI(csv);
  var link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", "items.csv");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Example usage
var items = [
  {
    attributes: {
      key1: "value1",
      key2: "value2",
      key3: "value3"
    }
  },
  {
    attributes: {
      key1: "value4",
      key2: "value5",
      key3: "value6"
    }
  },
  {
    attributes: {
      key1: "value7",
      key2: "value8",
      key3: "value9"
    }
  }
];

exportToCSV(items);
